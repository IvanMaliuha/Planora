<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Planora.ViewModels.ViewModels"
             x:Class="Planora.Views.LoginView"
             x:DataType="vm:LoginViewModel">

    <UserControl.Styles>
        <Style Selector="Border.FadeIn">
            <Style.Animations>
                <Animation Duration="0:0:1" Easing="CircularEaseOut"> 
                    <KeyFrame KeyTime="0:0:0">
                        <Setter Property="Opacity" Value="0.0"/>
                        <Setter Property="TranslateTransform.Y" Value="50"/>
                        <Setter Property="ScaleTransform.ScaleX" Value="0.9"/>
                        <Setter Property="ScaleTransform.ScaleY" Value="0.9"/>
                    </KeyFrame>
                    <KeyFrame KeyTime="0:0:1">
                        <Setter Property="Opacity" Value="1.0"/>
                        <Setter Property="TranslateTransform.Y" Value="0"/>
                        <Setter Property="ScaleTransform.ScaleX" Value="1.0"/>
                        <Setter Property="ScaleTransform.ScaleY" Value="1.0"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>

        <Style Selector="Ellipse.WhiteFallingSnow">
            <Style.Animations>
                <Animation Duration="0:0:5" IterationCount="1" FillMode="Forward">
                    <KeyFrame KeyTime="0:0:0">
                        <Setter Property="TranslateTransform.Y" Value="-50"/>
                    </KeyFrame>
                    <KeyFrame KeyTime="0:0:5">
                        <Setter Property="TranslateTransform.Y" Value="800"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>

        <Style Selector="Ellipse.BlueFallingSnow">
            <Style.Animations>
                <Animation Duration="0:0:12" IterationCount="1" FillMode="Forward">
                    <KeyFrame KeyTime="0:0:0">
                        <Setter Property="TranslateTransform.Y" Value="-50"/>
                    </KeyFrame>
                    <KeyFrame KeyTime="0:0:12">
                        <Setter Property="TranslateTransform.Y" Value="1000"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>
    </UserControl.Styles>

    <Grid>
        <Grid.Background>
            <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                <GradientStop Color="#E0F2FE" Offset="0"/>
                <GradientStop Color="#FFFFFF" Offset="1"/>
            </LinearGradientBrush>
        </Grid.Background>

        <Canvas x:Name="BackgroundSnowCanvas" IsHitTestVisible="False" />

        <Canvas x:Name="DynamicSnowCanvas" IsHitTestVisible="False" ZIndex="5"/>

        <Border Classes="FadeIn" 
                Background="White" CornerRadius="12" BoxShadow="0 10 30 0 #20000000"
                Margin="20" Padding="40" VerticalAlignment="Center" HorizontalAlignment="Center" Width="380"
                ZIndex="10">
            
            <StackPanel Spacing="20">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="-1">
                    <Grid ClipToBounds="False">
                        <TextBlock Text="P" FontSize="28" FontWeight="Bold" Foreground="#2563EB"/>
                        <Canvas Width="30" Height="30" Margin="-12,-16,0,0" IsHitTestVisible="False">
                            <Canvas.RenderTransform>
                                <RotateTransform Angle="-15"/>
                            </Canvas.RenderTransform>
                            <Path Fill="#DC2626" Data="M 22,12 Q 22,2 4,5 L 2,9 Z" />
                            <Border Width="14" Height="6" CornerRadius="3" Background="White"
                                    Canvas.Top="10" Canvas.Left="8" BorderBrush="Black" BorderThickness="1"/>
                            <Ellipse Width="8" Height="8" Fill="White"
                                     Canvas.Left="-2" Canvas.Top="3" Stroke="Black" StrokeThickness="1"/>
                        </Canvas>
                    </Grid>
                    <TextBlock Text="lanora" FontSize="28" FontWeight="Bold" Foreground="#2563EB"/>
                </StackPanel>
                
                <StackPanel Spacing="8">
                    <TextBlock Text="Логін" FontWeight="Medium"/>
                    <TextBox Text="{Binding Login, UpdateSourceTrigger=PropertyChanged}" Watermark="Ваш логін"/>
                </StackPanel>

                <StackPanel Spacing="8">
                    <TextBlock Text="Пароль" FontWeight="Medium"/>
                    <TextBox Text="{Binding Password, UpdateSourceTrigger=PropertyChanged}" PasswordChar="•" Watermark="Ваш пароль"/>
                </StackPanel>

                <Grid ColumnDefinitions="*,Auto">
                    <CheckBox Grid.Column="0" IsChecked="{Binding RememberMe}" Content="Запам'ятати мене"/>
                </Grid>

                <TextBlock Text="{Binding ErrorMessage}" Foreground="#DC2626" TextWrapping="Wrap"
                           FontSize="13" HorizontalAlignment="Center"
                           IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                <StackPanel Spacing="10" Margin="0,10,0,0">
                    <Button Command="{Binding LoginCommand}" Content="Увійти" 
                            HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                            Background="#2563EB" Foreground="White" FontWeight="SemiBold"/>

                    <Button Command="{Binding ResetCommand}" Content="Очистити поля"
                            HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                            Background="Transparent" Foreground="#6B7280"/>
                </StackPanel>

                <ProgressBar IsIndeterminate="True" IsVisible="{Binding IsLoading}" Height="2" Foreground="#2563EB"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>